From da0fe55a6b450ffe000e409dc4f58b51f469cb0d Mon Sep 17 00:00:00 2001
From: Daniel <danielituswapp@gmail.com>
Date: Wed, 24 Sep 2025 15:02:48 -0300
Subject: [PATCH] drivers/video/console/vgacon.c: instrument vgacon_scrolldelta
 to reward conditions necessary for the bug

---
 drivers/video/console/vgacon.c | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/drivers/video/console/vgacon.c b/drivers/video/console/vgacon.c
index e9254b3085a3..f2763d716ff5 100644
--- a/drivers/video/console/vgacon.c
+++ b/drivers/video/console/vgacon.c
@@ -306,6 +306,9 @@ static void vgacon_scrolldelta(struct vc_data *c, int lines)
 		vgacon_scrollback_cur->save = 1;
 	}
 
+	if (lines < 0){
+		pr_err("vgacon_scrolldelta called with lines less than 0.\n");
+	}
 	vgacon_scrollback_cur->restore = 0;
 	start = vgacon_scrollback_cur->cur + lines;
 	end = start + abs(lines);
@@ -321,7 +324,15 @@ static void vgacon_scrolldelta(struct vc_data *c, int lines)
 
 	if (end > vgacon_scrollback_cur->cnt)
 		end = vgacon_scrollback_cur->cnt;
-
+	if (vgacon_scrollback_cur->cnt > 0 ){
+		pr_err("vgacon_scrolldelta called with vgacon_scrollback_cur->cnt greater than 0.\n");
+	}
+	if (lines == -0x400){
+		pr_err("vgacon_scrolldelta called with lines exactly -0x400.\n");
+	}
+	if ( (vgacon_scrollback_cur->cnt > 0 ) && (lines < 0) ){
+		pr_err("vgacon_scrolldelta called with vgacon_scrollback_cur->cnt greater than 0 and lines less than 0.\n");
+	}
 	vgacon_scrollback_cur->cur = start;
 	count = end - start;
 	soff = vgacon_scrollback_cur->tail -
-- 
2.43.0

